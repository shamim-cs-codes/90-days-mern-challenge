<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Instagram • Shamim</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    .story-ring { @apply ring-4 ring-pink-500 ring-offset-2 ring-offset-black; }
    .progress-bar { transition: width 15s linear; }
  </style>
</head>
<body class="bg-black text-white min-h-screen md:bg-gray-950" x-data="instagram()">

  <!-- Header -->
  <header class="fixed top-0 left-0 right-0 bg-black border-b border-gray-800 z-50">
    <div class="flex items-center justify-between px-4 py-3">
      <h1 class="text-2xl font-bold">Instagram</h1>
      <div class="flex gap-6 text-2xl">
        <i class="far fa-heart cursor-pointer hover:text-gray-400"></i>
        <i class="far fa-paper-plane cursor-pointer hover:text-gray-400"></i>
      </div>
    </div>
  </header>

 <main class="pt-16 pb-24 max-w-lg mx-auto md:bg-black md:rounded-xl md:shadow-2xl md:mt-12 md:mb-32">

    <!-- Stories -->
    <div class="flex gap-4 p-4 overflow-x-auto scrollbar-hide bg-black">
      <!-- Your Story -->
      <div class="flex flex-col items-center cursor-pointer" @click="openStory(-1)">
        <div class="relative">
          <img src="assets/profile.jpg" class="w-16 h-16 rounded-full object-cover border-2 border-gray-800">
          <div class="absolute bottom-0 right-0 bg-blue-500 rounded-full p-1">
            <i class="fas fa-plus text-white text-xs"></i>
          </div>
        </div>
        <span class="text-xs mt-1">Your Story</span>
      </div>

      <template x-for="(story, index) in stories" :key="index">
        <div class="flex flex-col items-center cursor-pointer" @click="openStory(index)">
          <div :class="story.viewed ? 'opacity-60' : 'story-ring'">
            <img :src="story.avatar" class="w-16 h-16 rounded-full object-cover">
          </div>
          <span class="text-xs mt-1 truncate w-16" x-text="story.name"></span>
        </div>
      </template>
    </div>

    <!-- Feed -->
    <div class="space-y-8">
      <template x-for="post in posts" :key="post.id">
        <article class="bg-black rounded-lg overflow-hidden">
          <!-- Post Header -->
          <div class="flex items-center justify-between p-4">
            <div class="flex items-center gap-3">
              <img :src="post.avatar" class="w-10 h-10 rounded-full">
              <div>
                <p class="font-semibold" x-text="post.username"></p>
                <p class="text-xs text-gray-400" x-text="post.location"></p>
              </div>
            </div>
            <i class="fas fa-ellipsis-h cursor-pointer"></i>
          </div>

          <!-- Post Image -->
          <img :src="post.image" class="w-full">

          <!-- Actions -->
          <div class="p-4">
            <div class="flex justify-between text-3xl">
              <div class="flex gap-6">
                <i :class="post.liked ? 'fas fa-heart text-red-500' : 'far fa-heart'"
                   class="cursor-pointer hover:scale-125 transition" @click="toggleLike(post.id)"></i>
                <i class="far fa-comment cursor-pointer hover:scale-125 transition"></i>
                <i class="far fa-paper-plane cursor-pointer hover:scale-125 transition"></i>
              </div>
              <i class="far fa-bookmark cursor-pointer hover:scale-125 transition"></i>
            </div>

            <p class="mt-3 font-semibold" x-text="post.likes + ' likes'"></p>
            <p class="text-sm"><span class="font-semibold" x-text="post.username"></span> <span x-text="post.caption"></span></p>
            <p class="text-xs text-gray-400 mt-2" x-text="post.time"></p>
          </div>
        </article>
      </template>
    </div>
  </main>

  <!-- Story Viewer Modal -->
  <div x-show="storyOpen" class="fixed inset-0 bg-black z-50 flex items-center justify-center" 
       x-transition:enter="transition ease-out duration-300"
       x-transition:enter-start="opacity-0"
       x-transition:enter-end="opacity-100"
       @click.away="closeStory()" @keyup.escape.window="closeStory()">
    
    <div class="relative max-w-lg w-full">
      <!-- Progress Bars -->
      <div class="absolute top-0 left-0 right-0 flex gap-1 p-2 z-10">
        <template x-for="(s, i) in allStories" :key="i">
          <div class="flex-1 h-1 bg-gray-700 rounded-full overflow-hidden">
            <div class="h-full bg-white" 
                 :style="i < currentStoryIndex ? 'width: 100%' : i === currentStoryIndex ? `width: ${progress}%` : 'width: 0%'"
                 class="progress-bar"></div>
          </div>
        </template>
      </div>

      <!-- Story Content -->
      <img :src="currentStory.media" class="w-full">

      <!-- User Info -->
      <div class="absolute top-4 left-4 flex items-center gap-3">
        <img :src="currentStory.avatar" class="w-10 h-10 rounded-full">
        <div>
          <p class="font-semibold" x-text="currentStory.name"></p>
          <p class="text-xs" x-text="timeAgo(currentStory.time)"></p>
        </div>
      </div>

      <!-- Close Button -->
      <button @click="closeStory()" class="absolute top-4 right-4 text-3xl">&times;</button>

      <!-- Navigation -->
      <button @click="prevStory()" class="absolute left-2 top-1/2 -translate-y-1/2 text-4xl opacity-70">&lt;</button>
      <button @click="nextStory()" class="absolute right-2 top-1/2 -translate-y-1/2 text-4xl opacity-70">&gt;</button>
    </div>
  </div>

  <!-- Bottom Navigation (Mobile) -->
<div class="fixed inset-x-0 bottom-0 bg-black border-t border-gray-800 z-50 md:hidden">
  <div class="max-w-md mx-auto px-4 py-3 flex justify-between text-2xl">
    <i class="fas fa-home text-white"></i>
    <i class="fas fa-search text-gray-500"></i>
    <i class="fas fa-plus-square text-gray-500"></i>
    <i class="fas fa-heart text-gray-500"></i>
    <img src="assets/profile.jpg" class="w-7 h-7 rounded-full border-2 border-white object-cover" alt="profile">
  </div>
</div>

  <script>
    function instagram() {
      return {
        stories: [
          { name: "elonmusk", avatar: "assets/stories/story1.jpg", viewed: false },
          { name: "natasha", avatar: "assets/stories/story2.jpg", viewed: false },
          { name: "codingdev", avatar: "assets/stories/story3.jpg", viewed: true },
          { name: "design.ui", avatar: "assets/stories/story4.jpg", viewed: false },
          { name: "zuck", avatar: "assets/stories/story5.jpg", viewed: false }
        ],
        allStories: [
          { name: "Elon Musk", avatar: "assets/stories/story1.jpg", media: "assets/stories/story1.jpg", time: Date.now() - 3600000 },
          { name: "Natasha", avatar: "assets/stories/story2.jpg", media: "assets/stories/story2.jpg", time: Date.now() - 7200000 },
          { name: "Coding Dev", avatar: "assets/stories/story3.jpg", media: "assets/stories/story3.jpg", time: Date.now() - 10800000 },
          { name: "Design UI", avatar: "assets/stories/story4.jpg", media: "assets/stories/story4.jpg", time: Date.now() - 14400000 },
          { name: "Mark Z", avatar: "assets/stories/story5.jpg", media: "assets/stories/story5.jpg", time: Date.now() - 18000000 }
        ],
        posts: [
          { id: 1, username: "shamim.cs", avatar: "assets/profile.jpg", image: "assets/posts/post1.jpg", caption: "Day 7 of 90 – Instagram Clone with working stories", likes: 1240, location: "Bangladesh", time: "2 hours ago", liked: false },
          { id: 2, username: "elonmusk", avatar: "https://via.placeholder.com/40", image: "assets/posts/post2.jpg", caption: "To Mars", likes: 89210, location: "SpaceX", time: "5 hours ago", liked: true },
          // Add more...
        ],

        storyOpen: false,
        currentStoryIndex: 0,
        progress: 0,
        progressInterval: null,

        openStory(index) {
          this.currentStoryIndex = index === -1 ? 0 : index;
          this.storyOpen = true;
          this.progress = 0;
          this.startProgress();
          if (index >= 0) this.stories[index].viewed = true;
        },
        closeStory() { this.storyOpen = false; clearInterval(this.progressInterval); },
        nextStory() {
          if (this.currentStoryIndex < this.allStories.length - 1) {
            this.currentStoryIndex++;
            this.progress = 0;
            this.startProgress();
          } else this.closeStory();
        },
        prevStory() {
          if (this.currentStoryIndex > 0) {
            this.currentStoryIndex--;
            this.progress = 0;
            this.startProgress();
          }
        },
        startProgress() {
          clearInterval(this.progressInterval);
          this.progress = 0;
          this.progressInterval = setInterval(() => {
            this.progress += 0.667; // 100 / 15 seconds = ~0.667 per 100ms
            if (this.progress >= 100) this.nextStory();
          }, 100);
        },
        timeAgo(time) {
          const diff = Date.now() - time;
          const hours = Math.floor(diff / 3600000);
          return hours < 24 ? `${hours}h ago` : `${Math.floor(hours/24)}d ago`;
        },
        toggleLike(id) {
          const post = this.posts.find(p => p.id === id);
          if (post.liked) { post.likes--; post.liked = false; }
          else { post.likes++; post.liked = true; }
        },
        get currentStory() { return this.allStories[this.currentStoryIndex] || {}; }
      }
    }
  </script>
</body>
</html>